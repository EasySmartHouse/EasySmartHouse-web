<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
   "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
    
    <bean id="adapterProvider" class="by.ginger.smarthome.maxim.network.adapter.AdapterProviderImpl"
          singleton="true">
        <property name="adapterName" value="{DS9490}" />
        <property name="portName" value="USB1" />
    </bean>
  
    <bean id="searchExtension"
          class="by.ginger.smarthome.maxim.network.extension.OneWireSearchExtensionImpl"
          singleton="true" init-method="initExtension">
        <property name="adapter">
            <bean
                class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetObject" ref="adapterProvider" />
                <property name="propertyPath" value="adapter" />
            </bean>
        </property>
    </bean>
    
    <bean id="conversionExtension" class="by.ginger.smarthome.maxim.network.extension.OneWireConversionExtensionImpl" singleton="true">
        <property name="adapter">
            <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetObject" ref="adapterProvider" />
                <property name="propertyPath" value="adapter" />
            </bean>
        </property>
    </bean>
    
    <bean id="deviceConverter" class="by.ginger.smarthome.maxim.device.converter.OneWireDeviceConverter"/>
    
    <bean id="networkManager" class="by.ginger.smarthome.maxim.network.OneWireNetworkManager"  singleton="true">
        <property name="adapterProvider" ref="adapterProvider" />
        <property name="searchExtension" ref="searchExtension" />
        <property name="conversionExtension" ref="conversionExtension" />
        <property name="deviceConverter" ref="deviceConverter" />
    </bean>
  
    <bean id="timeManager" class="by.ginger.smarthome.sheduler.task.TimeManagerImpl" />
  
    <bean id="taskProcessor" class="by.ginger.smarthome.sheduler.task.TaskProcessorImpl">
        <property name="timeManager" ref="timeManager"/>
    </bean>
  
    <bean id="scheduler" class="by.ginger.smarthome.sheduler.SimpleSchedulerImpl" singleton="true">
        <property name="taskProcessor" ref="taskProcessor"/>
        <property name="networkManager" ref="networkManager"/>
    </bean>
</beans>